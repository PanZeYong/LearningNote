# 05 数组：为什么很多编程语言中数组都从0开始编号？

### 1、数组定义

数组（Array）是一种**线性表**数据结构。它用一组**连续的内存空间**，来存储一组具有**相同类型的数据**。特点如下：

- 线性表：零个或多个具有相同特性的数据元素组成的**有限序列**，线性表所有包含的元素个数称为线性表的长度。特点如下：

	- 序列

	- 有限的

	- 可以是有序的也可以是无序的

	- 线性表的开始元素只有后继元素没有前驱元素，而结束元素只有前驱元素没有后继元素；除了开始元素和结束元素外，每个元素有且只有一个前驱元素和后继元素。

	- 线性表的存储结构有顺序存储结构和链式存储结构，前者称为顺序表，后者称为链表，而数组属于前者。

- 连续的存储空间

- 相同的数据类型

- 随机访问

### 2、数组通过下标随机访问元素的原理

当我们创建一个一定长度的数组时，计算机会在内存中为该数组分配一块连续的内存空间，每个内存单元都有一个地址，内存块的首地址为 base_address，要访问数组的某个元素，可以通过寻址方式来访问，寻址公式：

```
a[i]_address = base_address + i * data_type_size;
```

### 3、数组操作中插入与删除的低效

对于一个有序数组，当我们要往数组中第 K 位置插入新元素时，为了保证其连续性和有序性，需要将第 K ~ n 元素移位，然后再插入新元素，最好的时间复杂度为 O(1)，最坏的时机复杂度为 O(n)，平均时间复杂度为 O(n)；删除操作也类似。

### 4、数组越界

```c
int main(int argc, char* argv[]){
    int arr[3] = {0};
    int i = 0;
    for(; i<=3; i++){
        arr[i] = 0;
        printf("hello world\n");
    }
    return 0;
}
```

在 C 语言中，数组越界不会报错，但是可能会导致死循环，与编译器的内存分配和字节对齐（8 字节对齐）有关。因为在 C 语言中，只要访问的内存不是受限的，那么内存空间就可以自由访问。比如上面的例子，刚好有 4 元素，满足 8 字节对齐，即arr[3] 在内存中即为 i 的地址，使 i 的值为 0，从而导致死循环。其它语言对于数组越界则会直接报错，比如 Java。

[GCC 中的编译器堆栈保护技术](https://www.ibm.com/developerworks/cn/linux/l-cn-gccstack/index.html)

### 5、数组与容器的区别

业务开发时建议使用容器，底层开发时使用数组。

### 6、数组下标从 0 开始，而不是 1 的原因

- CPU 减少一个减法指令；

- 历史原因。